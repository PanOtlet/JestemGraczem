{% extends "material/base.html.twig" %}

{% block beforeBody %}
    {% for event in events %}
        <div class="event">
            {{ event.html|raw }}
            {% if event.javascript %}
                <script>{{ event.javascript|raw }}</script>
            {% endif %}
            {% if event.css %}
                <style>{{ event.css|raw }}</style>
            {% endif %}
            {% if event.buttonUrl %}
                <a target="_blank" href="{{ event.buttonUrl }}"
                   class="btn btn-primary btn-block waves-effect waves-light">
                    {{ event.buttonText }}
                </a>
            {% endif %}
        </div>
    {% endfor %}
    <div id="slider" class="carousel slide carousel-fade divShadow" data-ride="carousel">
        <ol class="carousel-indicators hidden-sm-up">
            {% for slider in sliders %}
                {% if loop.index == 1 %}
                    <li data-target="#slider" data-slide-to="{{ loop.index0 }}" class="active"></li>
                {% else %}
                    <li data-target="#slider" data-slide-to="{{ loop.index0 }}" class=""></li>
                {% endif %}
            {% endfor %}
        </ol>
        <div class="carousel-inner" role="listbox">
            {% for slider in sliders %}
                {% if loop.index == 1 %}
                    <div class="carousel-item active">
                        <div class="flex-center animated fadeInDown">
                            <ul>
                                <li>
                                    <h1 class="h1-responsive tag purple">{{ slider.title }}</h1>
                                </li>
                                <li>
                                    <p class="tag purple">{{ slider.description }}</p>
                                </li>
                                {% if slider.buttonUrl %}
                                    <li>
                                        <a target="_blank" href="{{ slider.buttonUrl }}"
                                           class="btn btn-primary btn-lg waves-effect waves-light">{{ slider.buttonText }}</a>
                                    </li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                {% else %}
                    <div class="carousel-item">
                        <div class="flex-center animated fadeInDown">
                            <ul>
                                <li>
                                    <h1 class="h1-responsive tag red">{{ slider.title }}</h1>
                                </li>
                                <li>
                                    <p class="tag red">{{ slider.description }}</p>
                                </li>
                                {% if slider.buttonUrl %}
                                    <li>
                                        <a target="_blank" href="{{ slider.buttonUrl }}"
                                           class="btn btn-primary btn-lg waves-effect waves-light">{{ slider.buttonText }}</a>
                                    </li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
        <a class="left carousel-control hidden-sm-up" href="#slider" role="button" data-slide="prev">
            <span class="icon-prev" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control hidden-sm-up" href="#slider" role="button" data-slide="next">
            <span class="icon-next" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
{% endblock %}

{% block body %}
    <div class="divider-new">
        <h2 class="h2-responsive wow bounceIn">Polecane streamy</h2>
    </div>

    {#<div id="stream-container" class="divShadow">#}
    {#<div class="container">#}
    {#<section id="stream">#}
    {#<div class="row">#}
    {#<div class="col-md-8 hidden-md-down">#}
    {#<div class="embed-responsive embed-responsive-16by9">#}
    {#<iframe id="topstream" class="embed-responsive-item"#}
    {#src="https://beam.pro/embed/player/monstercat"></iframe>#}
    {#</div>#}
    {#</div>#}
    {#<div class="col-md-4">#}
    {#<ul class="text-xs-center">#}
    {#<li class="wow fadeInUp" data-wow-delay="0.5s">#}
    {#<img id="avatar" class="img-fluid hidden-md-down"#}
    {#src="https://www.gravatar.com/avatar/{{ avatar }}?s=25" alt="Gravatar Avatar">#}
    {#<h3 id="display_name" style="margin-top: 30pt" class="h3-responsive tag red">Brak</h3>#}
    {#</li>#}

    {#<li class="wow fadeInUp" data-wow-delay="1.0s">#}
    {#<p id="link" class="tag grey">Niestety nikt nie streamuje :(</p>#}
    {#</li>#}

    {#<li class="wow fadeInUp tag black" data-wow-delay="1.5s">#}
    {#Widzów: <span id="viewers">n/d</span>#}
    {#</li>#}
    {#</ul>#}
    {#</div>#}
    {#</div>#}
    {#<div class="container-fluid" id="streams-container">#}

    {#</div>#}
    {#</section>#}
    {#</div>#}
    {#</div>#}

    <div id="stream-container" class="divShadow hidden-sm-up">
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <div class="swiper-slide" id="streamLoading">
                    <div class="view">
                        <img src="http://jestemgraczem.pl/assets/img/bg_defoult.png" class="img-fluid"
                             alt="JestemGraczem Loading">
                        <div class="mask pattern-1 flex-center">
                            <a class="stream-title" href="#">LOADING</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-scrollbar"></div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="marginus m-x-auto d-block">
            {% block adbanner %}{{ parent() }}{% endblock %}
        </div>
    </div>

    <div id="news" class="divShadow">
        <div class="container-fluid">
            <div class="row">
                {% for article in articles %}
                    <div class="col-md-4">
                        <div class="card">
                            {% if article.imageName %}
                                <div class="view overlay hm-white-slight">
                                    <img src="{{ app.request.basePath }}{{ vich_uploader_asset(article, 'imageFile', 'NewsBundle\\Entity\\News') }}"
                                         class="img-fluid" alt="{{ article.title }}">
                                    <a href="{{ url('article.id',{'id': article.id, 'title': article.title|replace({' ': '-'})}) }}">
                                        <div class="mask"></div>
                                    </a>
                                </div>
                            {% endif %}
                            <div class="card-block">
                                <h4 class="card-title">{{ article.title|slice(0,25) }}</h4>
                                <p class="card-text">{{ article.introduction|slice(0,100) }}...</p>
                                <a href="{{ url('article.id',{'id': article.id, 'title': article.title|replace({' ': '-'})}) }}"
                                   class="btn btn-info">Czytaj dalej...</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <a href="{{ url('articles') }}" class="btn btn-block btn-purple waves-effect">
                Czytaj więcej...
            </a>
        </div>
    </div>

    <div id="newestmems" class="container p-t-1">
        <div class="row">
            <a href="{{ url('mem.all') }}">
                <h3>
                    <span class="tag tag-pill white text-muted">{{ 'button.newest.new'|trans }}</span>
                    <span class="tag tag-pill red">{{ 'button.newest.meme'|trans }}</span>
                </h3>
            </a>
            {% for mem in mems %}
                {% if loop.index == 1 or loop.index == 4 %}
                    <div class="row">
                {% endif %}
                {% if mem.url | slice(-4) == '.mp4' or mem.url | slice(-5) == '.webm' %}
                    <div class="col-md-4">
                        <div class="embed-responsive embed-responsive-16by9 m-b-1">
                            <video id="promotedMemes" class="video-js embed-responsive-item" controls preload="auto"
                                   data-setup="{}">
                                <source src="{{ asset('assets/mem/') ~ mem.url }}" type="video/mp4"
                                        class="embed-responsive-item">
                                <p class="vjs-no-js">
                                    Masz kiepską przeglądarkę! Użyj GOOGLE CHROME!
                                </p>
                            </video>
                        </div>
                    </div>
                {% else %}
                    <div class="col-md-4">
                        <a href="{{ url('mem.id', { 'id':mem.id }) }}" data-toggle="tooltip" title="{{ mem.title }}">
                            <img class="img-fluid img-mem mb-1" src="{{ asset('assets/mem/') ~ mem.url }}"
                                 alt="{{ mem.title }}">
                        </a>
                    </div>
                {% endif %}
                {% if loop.index == 3 or loop.index == 6 %}
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <div id="videoFluidContainer" class="divShadow">
        <div id="newestVideo" class="container-fluid">
            <div id="newestvideos" class="row">
                <div class="col-md-12">
                    <a href="{{ url('video') }}">
                        <h3>
                            <span class="tag tag-pill white text-muted">{{ 'button.newest.new'|trans }}</span>
                            <span class="tag tag-pill red">{{ 'button.newest.video'|trans }}</span>
                        </h3>
                    </a>
                    <div class="container-fluid">
                        <div class="row">
                            {% for vod in video %}
                                <div class="col-md-3 mb-1">
                                    <div class="view">
                                        <img src="//img.youtube.com/vi/{{ vod.videoid }}/mqdefault.jpg"
                                             class="img-fluid" alt="{{ vod.title }}">
                                        <div class="mask pattern-2 flex-center">
                                            <a href="{{ url('video.id', { 'id':vod.id }) }}"
                                               class="white-text stream-title">
                                                {{ vod.title|slice(0,25) }}...
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {#<div id="socialMedia">#}
    {#<div class="container-fluid">#}
    {#<div class="row">#}
    {#<div class="col-md-4">#}
    {#<div class="card card-block">#}
    {#<div id="fb-root"></div>#}
    {#<div class="fb-page" data-href="https://www.facebook.com/jestemgraczempl/"#}
    {#data-small-header="false"#}
    {#data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="false">#}
    {#<blockquote cite="https://www.facebook.com/jestemgraczempl/" class="fb-xfbml-parse-ignore">#}
    {#<a#}
    {#href="https://www.facebook.com/jestemgraczempl/">JestemGraczem.pl</a>#}
    {#</blockquote>#}
    {#</div>#}
    {#</div>#}
    {#</div>#}

    {#<div class="col-md-4">#}
    {#<div class="card card-block">#}
    {#<div class="g-ytsubscribe" data-channelid="UCwyKvaFQcBfJ7dCxM_uX5EQ" data-layout="full"#}
    {#data-count="default"></div>#}
    {#<br>#}
    {#<div class="g-ytsubscribe" data-channel="PanOtlet" data-layout="full"#}
    {#data-count="default"></div>#}
    {#</div>#}
    {#</div>#}

    {#<div class="col-md-4">#}
    {#<div class="card card-block">#}
    {#<div class="g-page" data-href="//plus.google.com/u/4/116516903644267522146"#}
    {#data-layout="landscape"#}
    {#data-rel="publisher"></div>#}
    {#</div>#}
    {#</div>#}

    {#</div>#}
    {#</div>#}
    {#</div>#}
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="https://vjs.zencdn.net/5.12.6/video-js.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.1/css/swiper.min.css">
    <style>
        {% for slide in sliders %}
        .carousel-item:nth-child({{ loop.index }}) {
            background: url("{{ slide.image }}") no-repeat;
            background-size: cover;
            opacity: 0.4;
        }

        {% endfor %}
    </style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.3.0/mustache.min.js"
            integrity="sha256-iaqfO5ue0VbSGcEiQn+OeXxnxAMK2+QgHXIDA5bWtGI=" crossorigin="anonymous"></script>
    <script src="{{ asset('assets/js/ads.js') }}"></script>
    <script src="{{ asset('assets/js/homepage.js') }}"></script>
    <script src="https://vjs.zencdn.net/5.12.6/video.js"></script>
    <link rel="stylesheet" href="{{ asset('assets/material/css/videojs.css') }}">
    <script src="https://apis.google.com/js/platform.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.1/js/swiper.jquery.min.js"></script>
    <script>
        var stream = new Stream('{{ path("api.stream") }}');
        if (typeof ads !== 'undefined')
            stream.start(true);
        else
            stream.start(false);

        window.___gcfg = {lang: 'pl'};
        (function () {
            var po = document.createElement('script');
            po.type = 'text/javascript';
            po.async = true;
            po.src = 'https://apis.google.com/js/platform.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(po, s);
        })
        ();
        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = "//connect.facebook.net/pl_PL/sdk.js#xfbml=1&version=v2.7&appId=1792775277616619";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
{% endblock %}